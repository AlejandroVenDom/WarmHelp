<div class="tienda-y-carrito">
<div class="tienda-container">
  <h2 class="title">Servicios Profesionales</h2>
  <!-- Filtros -->
  <div class="filters-container">
    <!-- Botón de Filtros con toggle -->
<button class="btn-filter" (click)="mostrarFiltros = !mostrarFiltros">
  <i class="bi bi-funnel-fill"></i> Filtros
</button>
    <!-- Botón de carrito -->
    <button class="btn-order" (click)="toggleCart()">
      <i class="bi bi-cart4"></i> Carrito
    </button>
  </div>
  <!-- Grid de servicios -->
  <div class="product-grid">
    <div class="no-results" *ngIf="filteredServices.length === 0">
      <i class="bi bi-emoji-frown"></i>
      <p>No hay servicios que coincidan con tu búsqueda.</p>
    </div>
    <div *ngFor="let servicio of filteredServices" class="product-card" (click)="goToServicio(servicio)">
      <div class="product-info">
        <img [src]="servicio.image || '/ans.jpg'" alt="Imagen del servicio" class="cart-img">
        <h3>{{ servicio.title }}</h3>
        <p class="product-description">{{ servicio.description.length > 15 ? (servicio.description | slice:0:15) + '...' : servicio.description }}</p>
        <p class="price">Precio: {{ servicio.price }} {{ servicio.currencyType }}</p>
        <!-- <p class="price">Impuesto: {{ servicio.tax }} {{ servicio.currencyType }}</p> -->
        <p>
          Publicado por:
          <span class="link-perfil" (click)="verPerfilPublico(servicio.userName); $event.stopPropagation()">
            {{ servicio.userName || 'Desconocido' }}
          </span>
        </p>
        <p class="created-at" *ngIf="servicio.createdAt">
          <i class="bi bi-calendar-event"></i>
          Publicado el: {{ servicio.createdAt | date:'short' }}
        </p>
      </div>
      <button class="btn-add-cart" (click)="addToCart(servicio); $event.stopPropagation()">
        <i class="bi bi-cart-plus"></i>
      </button>
    </div>
  </div>
  <button *ngIf="mostrarBotonScroll" class="scroll-top-btn fade-in" (click)="scrollToTop()" title="Volver arriba">
    <i class="bi bi-arrow-up-circle-fill"></i>
  </button>
</div>
<app-cart></app-cart>
<app-filtros
  [isOpen]="mostrarFiltros"
  [searchTerm]="searchTerm"
  [minPrice]="minPrice"
  [maxPrice]="maxPrice"
  [priceRangeMin]="priceRangeMin"
  [priceRangeMax]="priceRangeMax"
  (searchChange)="searchTerm = $event; filterServicios()"
  (priceChange)="minPrice = $event.min; maxPrice = $event.max; filterServicios()"
  (reset)="resetFilters()"
  (close)="mostrarFiltros = false"
  (orderChange)="ordenarServicios($event)"
  [availableCurrencies]="monedasUnicas"
  [selectedCurrency]="selectedCurrency"
  (currencyChange)="selectedCurrency = $event; filterServicios()"
></app-filtros>
</div>
