<div class="cart-sidebar" [class.visible]="visible">
  <div class="cart-header">
    <h3><i class="bi bi-cart-fill"></i> Tu carrito</h3>
    <button class="close-btn" (click)="close()" aria-label="Cerrar carrito">
      <i class="bi bi-x-lg"></i>
    </button>
  </div>

  <div class="cart-content">
    <div *ngIf="cartItems.length === 0" class="empty-cart">
      <i class="bi bi-cart-x"></i>
      <p>Tu carrito está vacío</p>
    </div>

    <div *ngFor="let item of cartItems" class="cart-item">
      <img [src]="item.image || '/ans.jpg'" alt="Imagen del servicio" />
      <div class="item-details">
        <h4>{{ item.serviceTitle }}</h4>
        <p class="item-meta">
          {{ item.priceUd }} {{ item.currency }} × {{ item.quantity }}
        </p>
        <div class="quantity-controls">
          <button (click)="decreaseQuantity(item)" aria-label="Quitar uno">
            <i class="bi bi-dash-circle"></i>
          </button>

          <span [id]="'qty-' + item.cartItemId" class="quantity-number">
            {{ item.quantity }}
          </span>

          <button (click)="increaseQuantity(item)" aria-label="Agregar uno">
            <i class="bi bi-plus-circle"></i>
          </button>
        </div>
        <p class="item-total">Total: {{ item.totalPrice }} {{ item.currency }}</p>
      </div>
      <button class="remove-btn" (click)="remove(item.cartItemId!)" aria-label="Eliminar">
        <i class="bi bi-trash3-fill"></i>
      </button>
    </div>
  </div>

  <div class="cart-footer" *ngIf="cartItems.length > 0">
    <div class="total-line">
      <span>Total:</span>
      <strong>{{ total.toFixed(2) }} {{ cartItems[0]?.currency || '' }}</strong>
    </div>
    <button class="checkout-btn" (click)="checkout()">
      <i class="bi bi-check-circle-fill"></i> Finalizar compra
    </button>
  </div>
</div>
