<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<div class="register-wrapper">
  <div class="backtologin">
      <a class="btn-back text-decoration-none" routerLink="/login"><i class="fa-solid fa-arrow-left"></i> Volver</a>
  </div>
    <div class="register-header">
      <h2 class="register-title">Registrarme</h2>
    </div>
    <!-- Pantalla de espera -->
    <div *ngIf="isLoading" class="loading-overlay">
      <div class="spinner">
        <i class="fa fa-spinner fa-spin"></i>
      </div>
      <p>Estamos procesando tu registro...</p>
    </div>

    <form method="post" [formGroup]="registerForm" (ngSubmit)="submit()">
      <div class="form-grid">
        <!-- Campo de Usuario -->
        <div class="register-field">
          <label class="register-label">Nombre de usuario</label>
          <div class="input-container">
            <i class="bi bi-person icon"></i>
            <input class="register-input" type="text" placeholder="Introduce tu nombre de usuario de WarmHelp..." formControlName="username" />
          </div>
        </div>

        <!-- Campo de Contraseña -->
        <div class="register-field">
          <label class="register-label">Contraseña</label>
          <div class="input-container">
            <i class="bi bi-lock icon"></i>
            <input class="register-input" [type]="showPassword ? 'password' : 'text'" placeholder="*****" formControlName="password" />
            <i class="bi" [ngClass]="showPassword ? 'bi-eye-slash' : 'bi-eye'" (click)="togglePasswordVisibility()"></i>
          </div>
        </div>

        <!-- Selección de Rol -->
        <div class="register-field">
          <label class="register-label">¿Qué tipo de cuenta deseas crear?</label>
          <select class="register-select" formControlName="roleType">
            <optgroup label="Seleccione una opción">
            <option value="" disabled selected>Selecciona una opción</option>
              <option value="CLIENT">Usuario WarmHelp - Busca y contrata servicios</option>
              <option value="PROFESSIONAL">Vendedor profesional de servicios - Ofrece tus servicios</option>
            </optgroup>
          </select>
        </div>

        <!-- Campo de Nombre -->
        <div class="register-field">
          <label class="register-label">Nombre</label>
          <div class="input-container">
            <i class="bi bi-person-circle icon"></i>
            <input class="register-input" type="text" placeholder="Introduce tu nombre..." formControlName="first_name" />
          </div>
        </div>

        <!-- Campo de Apellidos -->
        <div class="register-field">
          <label class="register-label">Apellidos</label>
          <div class="input-container">
            <i class="bi bi-people icon"></i>
            <input class="register-input" type="text" placeholder="Introduce tus apellidos..." formControlName="last_name" />
          </div>
        </div>

        <!-- Campo de Dirección -->
        <div class="register-field">
          <label class="register-label">Dirección</label>
          <div class="input-container">
            <i class="bi bi-house icon"></i>
            <input class="register-input" type="text" placeholder="Dirección Postal" formControlName="address" />
          </div>
        </div>

        <!-- Campo de Teléfono -->
        <div class="register-field">
          <label class="register-label">Número de Teléfono</label>
          <div class="input-container">
            <i class="bi bi-telephone icon"></i>
            <input class="register-input" type="text" placeholder="+34 123 456 789" formControlName="number" />
          </div>
        </div>

        <!-- Campo de Email -->
        <div class="register-field">
          <label class="register-label">Email</label>
          <div class="input-container">
            <i class="bi bi-envelope icon"></i>
            <input class="register-input" type="email" placeholder="****@gmail.com" formControlName="email" />
          </div>
        </div>

        <!-- Campo de Descripción -->
        <div class="register-field" style="grid-column: span 2;">
          <label class="register-label"><i class="bi bi-info-circle icon"></i> Presentación personal</label>
          <div class="input-container">
            <textarea class="register-input" rows="5" style="width: 100%; border-radius: 10px; border-color: #3A7D44;"
            placeholder="  Agrega una breve descripción sobre ti..." formControlName="mySelf_description"></textarea>
          </div>
        </div>
      </div>

      <!-- Botón de Registro -->
      <div class="register-footer">
        <button type="submit" class="register-btn" [disabled]="registerForm.invalid">Finalizar registro</button>
      </div>
    </form>
    
  <!-- Botón de Continuar después de la Verificación -->
  <!-- ... (todo el HTML anterior se mantiene igual hasta el final) -->

<!-- Reemplaza el bloque verification-message por este: -->
<div *ngIf="isWaitingForVerification" class="verification-message">
  <h3>¡Registro exitoso!</h3>
  <p>Hemos enviado un enlace a <strong>{{ emailSentTo }}</strong>.</p>
  
  <div class="verification-loader">
    <i class="fa fa-spinner fa-spin"></i>
    <p>Esperando verificación...</p>
  </div>

  <button (click)="continueAfterVerification()" class="btn-continue">Continuar</button>
  <button (click)="resendVerificationEmail()" class="btn-resend">Reenviar correo</button>
</div>
