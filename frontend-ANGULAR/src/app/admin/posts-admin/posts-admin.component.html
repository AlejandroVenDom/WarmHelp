<div class="admin-posts-container">
  <h2 class="titulo-seccion">
    <i class="bi bi-newspaper"></i> Panel de Administración de Posts
  </h2>

  <div class="acciones-admin">
    <div class="buscador">
      <input type="text" [(ngModel)]="filtroBusqueda" (input)="filtrarPosts()" placeholder="Buscar...">
      <button (click)="resetearFiltros()" title="Resetear filtros"><i class="bi bi-arrow-clockwise"></i></button>
    </div>
    <div class="cantidad">
      <label>Mostrar:</label>
      <select [(ngModel)]="cantidadMostrar" (change)="onCantidadChange()">
        <option *ngFor="let c of cantidadesDisponibles" [value]="c">{{ c }}</option>
      </select>
    </div>
  </div>

  <div class="admin-lista">
    <div *ngFor="let post of posts" class="post-card">
      <ng-container *ngIf="editando && postEditando && postEditando.id === post.id">
        <input [(ngModel)]="postEditando.title" placeholder="Título" />
        <textarea [(ngModel)]="postEditando.description" rows="3" placeholder="Descripción"></textarea>
        <input [(ngModel)]="postEditando.image" placeholder="URL de imagen" />
        <div class="acciones">
          <button class="btn-guardar" (click)="guardarCambios()">Guardar</button>
          <button class="btn-cancelar" (click)="cancelarEdicion()">Cancelar</button>
        </div>
      </ng-container>

      <ng-container *ngIf="!(editando && postEditando && postEditando.id === post.id)">
        <div class="post-header">
          <h4><i class="bi bi-pencil-square"></i> {{ post.title }}</h4>
          <span class="autor"><i class="bi bi-person-fill"></i> {{ post.username }}</span>
        </div>
        <p class="descripcion">{{ post.description }}</p>
        <div class="info-extra">
          <p><i class="bi bi-image-fill"></i> <strong>Imagen:</strong> {{ post.image || 'Ninguna' }}</p>
          <p><i class="bi bi-chat-dots-fill"></i> <strong>Comentarios:</strong> {{ post.comments?.length || 0 }}</p>
          <p><i class="bi bi-hand-thumbs-up-fill"></i> <strong>Likes:</strong> {{ post.likes_posts?.length || 0 }}</p>
          <p><i class="bi bi-calendar-event-fill"></i> <strong>Fecha:</strong> {{ post.createdAt | date:'short' }}</p>
        </div>
        <div class="acciones">
          <button class="btn-eliminar"
        [disabled]="eliminandoId === post.id"
        (click)="eliminarPost(post.id)">
  <i *ngIf="eliminandoId === post.id" class="bi bi-hourglass-split"></i>
  <span *ngIf="eliminandoId !== post.id">Eliminar</span>
</button>
        </div>
      </ng-container>
    </div>
  </div>

  <div class="paginacion" *ngIf="totalPaginas > 1">
    <button (click)="cambiarPagina(-1)" [disabled]="paginaActual === 1">Anterior</button>
    <span *ngFor="let p of paginas" [class.activa]="p === paginaActual" (click)="irAPagina(p)">
      {{ p }}
    </span>
    <button (click)="cambiarPagina(1)" [disabled]="paginaActual === totalPaginas">Siguiente</button>
  </div>
</div>
